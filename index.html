
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IOE K6 - 104 C√ÇU GI·ªöI T·ª™</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <style>
      body { font-family: 'Nunito', sans-serif; background-color: #f1f5f9; margin: 0; }
      .custom-scrollbar::-webkit-scrollbar { width: 4px; }
      .custom-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; }
      .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
      @keyframes fadeIn { from { opacity: 0; transform: scale(0.98); } to { opacity: 1; transform: scale(1); } }
      .animate-fade-in { animation: fadeIn 0.2s ease-out forwards; }
      @keyframes slideUp { from { transform: translateY(8px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
      .animate-slide-up { animation: slideUp 0.2s ease-out forwards; }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.3",
    "react/": "https://esm.sh/react@^19.2.3/"
  }
}
</script>
</head>
<body class="antialiased text-slate-900">
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect, useMemo } = React;

      const GameState = { START: 'START', PLAYING: 'PLAYING', FINISHED: 'FINISHED' };

      const RAW_QUESTIONS = [
        { q: "Do you enjoy driving____ night?", o: ["in", "during", "at", "on"], a: "at", h: "at night: v√†o ban ƒë√™m", t: "B·∫°n c√≥ th√≠ch l√°i xe v√†o ban ƒë√™m kh√¥ng?" },
        { q: "I‚Äôm taking my driving test _____ 4.30_____ July 3rd.", o: ["in/at", "at/in", "at/on", "on/at"], a: "at/on", h: "at + gi·ªù, on + ng√†y th√°ng", t: "T√¥i s·∫Ω thi l·∫•y b·∫±ng l√°i xe v√†o l√∫c 4 gi·ªù 30 ng√†y 3 th√°ng 7." },
        { q: "He was born____ 1900 and died____ 1972.", o: ["in/in", "in/on", "from/to", "in/on"], a: "in/in", h: "in + nƒÉm", t: "√îng ·∫•y sinh nƒÉm 1900 v√† m·∫•t nƒÉm 1972." },
        { q: "____ the end of the film I felt very sad.", o: ["on", "towards", "at", "in"], a: "at", h: "at the end of: v√†o l√∫c k·∫øt th√∫c", t: "V√†o cu·ªëi b·ªô phim, t√¥i c·∫£m th·∫•y r·∫•t bu·ªìn." },
        { q: "I hated school at first, but_____ the end I quite enjoyed it.", o: ["in", "at", "of", "to"], a: "in", h: "in the end: cu·ªëi c√πng, r·ªët cu·ªôc", t: "L√∫c ƒë·∫ßu t√¥i gh√©t ƒëi h·ªçc, nh∆∞ng cu·ªëi c√πng t√¥i l·∫°i kh√° th√≠ch n√≥." },
        { q: "They‚Äôre going to Italy____ the end of next week.", o: ["at", "in", "on", "from"], a: "at", h: "at the end of: v√†o cu·ªëi c·ªßa...", t: "H·ªç s·∫Ω ƒëi √ù v√†o cu·ªëi tu·∫ßn t·ªõi." },
        { q: "Some people were talking in the cinema____ the film.", o: ["during", "in", "with", "over"], a: "during", h: "during: trong su·ªët (s·ª± ki·ªán)", t: "M·ªôt s·ªë ng∆∞·ªùi ƒë√£ n√≥i chuy·ªán trong r·∫°p khi b·ªô phim ƒëang chi·∫øu." },
        { q: "We‚Äôve been waiting_____ almost an hour.", o: ["in", "during", "since", "for"], a: "for", h: "for + kho·∫£ng th·ªùi gian", t: "Ch√∫ng t√¥i ƒë√£ ƒë·ª£i g·∫ßn m·ªôt ti·∫øng ƒë·ªìng h·ªì r·ªìi." },
        { q: "They hope to finish the job____ Thursday next week", o: ["on", "at", "for", "by"], a: "by", h: "by: tr∆∞·ªõc/mu·ªôn nh·∫•t l√†...", t: "H·ªç hy v·ªçng s·∫Ω ho√†n th√†nh c√¥ng vi·ªác tr∆∞·ªõc th·ª© NƒÉm tu·∫ßn sau." },
        { q: "I‚Äôve known her_____ three months.", o: ["since", "for", "in", "during"], a: "for", h: "for + kho·∫£ng th·ªùi gian", t: "T√¥i ƒë√£ bi·∫øt c√¥ ·∫•y ƒë∆∞·ª£c ba th√°ng r·ªìi." },
        { q: "My grandparents visited Edinburgh______ two weeks in 1980.", o: ["since", "in", "from", "for"], a: "for", h: "for + kho·∫£ng th·ªùi gian", t: "√îng b√† t√¥i ƒë√£ ƒë·∫øn thƒÉm Edinburgh trong hai tu·∫ßn v√†o nƒÉm 1980." },
        { q: "They had been there five years ______ so it wasn‚Äôt completely new to them.", o: ["before", "ago", "for", "since"], a: "before", h: "before: tr∆∞·ªõc ƒë√≥ (trong qu√° kh·ª©)", t: "H·ªç ƒë√£ ·ªü ƒë√≥ nƒÉm nƒÉm tr∆∞·ªõc ƒë√≥, n√™n n∆°i n√†y kh√¥ng ho√†n to√†n m·ªõi l·∫° v·ªõi h·ªç." },
        { q: "My brother has been interested in music_______ quite a long time.", o: ["before", "ago", "for", "since"], a: "for", h: "for a long time", t: "Anh trai t√¥i ƒë√£ y√™u th√≠ch √¢m nh·∫°c trong m·ªôt th·ªùi gian kh√° d√†i." },
        { q: "He was given his first guitar 20 years______.", o: ["since", "for", "before", "ago"], a: "ago", h: "ago: c√°ch ƒë√¢y (qu√° kh·ª© ƒë∆°n)", t: "Anh ·∫•y ƒë∆∞·ª£c t·∫∑ng c√¢y ƒë√†n guitar ƒë·∫ßu ti√™n c√°ch ƒë√¢y 20 nƒÉm." },
        { q: "She has been working for the same newspaper ever ______then", o: ["since", "for", "ago", "before"], a: "since", h: "ever since then: k·ªÉ t·ª´ ƒë√≥", t: "C√¥ ·∫•y ƒë√£ l√†m vi·ªác cho c√πng m·ªôt t·ªù b√°o k·ªÉ t·ª´ ƒë√≥ ƒë·∫øn nay." },
        { q: "His car had broken down and he had to come ____ taxi.", o: ["like", "in", "by", "on"], a: "by", h: "by + ph∆∞∆°ng ti·ªán", t: "Xe c·ªßa anh ·∫•y b·ªã h·ªèng v√† anh ·∫•y ƒë√£ ph·∫£i ƒëi b·∫±ng taxi." },
        { q: "The journey takes 10 minutes by bus and about 25 minutes ______foot.", o: ["on", "in", "by", "at"], a: "on", h: "on foot: ƒëi b·ªô", t: "H√†nh tr√¨nh m·∫•t 10 ph√∫t ƒëi xe bu√Ωt v√† kho·∫£ng 25 ph√∫t ƒëi b·ªô." },
        { q: "They are very proud______ their children.", o: ["of", "with", "from", "for"], a: "of", h: "proud of: t·ª± h√†o v·ªÅ", t: "H·ªç r·∫•t t·ª± h√†o v·ªÅ nh·ªØng ƒë·ª©a con c·ªßa m√¨nh." },
        { q: "Are you worried ______ yor driving test?", o: ["for", "with", "by", "about"], a: "about", h: "worried about: lo l·∫Øng v·ªÅ", t: "B·∫°n c√≥ lo l·∫Øng v·ªÅ k·ª≥ thi s√°t h·∫°ch l√°i xe c·ªßa m√¨nh kh√¥ng?" },
        { q: "You‚Äôre very good _____ explaining things.", o: ["on", "about", "in", "at"], a: "at", h: "good at: gi·ªèi v·ªÅ", t: "B·∫°n r·∫•t gi·ªèi trong vi·ªác gi·∫£i th√≠ch m·ªçi th·ª©." },
        { q: "Sydney in Australia is famous _____ its Opera House.", o: ["for", "about", "with", "from"], a: "for", h: "famous for: n·ªïi ti·∫øng v√¨", t: "Sydney ·ªü √öc n·ªïi ti·∫øng v·ªõi Nh√† h√°t Opera." },
        { q: "She‚Äôs quite capable____ doing the job.", o: ["in", "at", "on", "of"], a: "of", h: "capable of: c√≥ kh·∫£ nƒÉng", t: "C√¥ ·∫•y ho√†n to√†n c√≥ kh·∫£ nƒÉng th·ª±c hi·ªán c√¥ng vi·ªác ƒë√≥." },
        { q: "We‚Äôre getting really excited_____ our holiday.", o: ["about", "of", "in", "for"], a: "about", h: "excited about: h√†o h·ª©ng v·ªÅ", t: "Ch√∫ng t√¥i ƒëang th·ª±c s·ª± h√†o h·ª©ng v·ªÅ k·ª≥ ngh·ªâ c·ªßa m√¨nh." },
        { q: "Are you interested_____ playing tennis tomorrow?", o: ["in", "at", "on", "of"], a: "in", h: "interested in: th√≠ch th√∫", t: "B·∫°n c√≥ h·ª©ng th√∫ ch∆°i tennis v√†o ng√†y mai kh√¥ng?" },
        { q: "He‚Äôs not very keen ____ football.", o: ["on", "at", "with", "for"], a: "on", h: "keen on: say m√™", t: "Anh ·∫•y kh√¥ng m·∫∑n m√† l·∫Øm v·ªõi m√¥n b√≥ng ƒë√°." },
        { q: "It was very kind ____ them to give us a lift to the station.", o: ["of", "to", "in", "at"], a: "of", h: "kind of someone: ai ƒë√≥ th·∫≠t t·ªët", t: "H·ªç th·∫≠t t·ªët b·ª•ng khi cho ch√∫ng t√¥i ƒëi nh·ªù ra ga." },
        { q: "Are you afraid____ flying?", o: ["of", "about", "at", "with"], a: "of", h: "afraid of: s·ª£ c√°i g√¨", t: "B·∫°n c√≥ s·ª£ ƒëi m√°y bay kh√¥ng?" },
        { q: "The garden is full____ roses.", o: ["of", "by", "with", "for"], a: "of", h: "full of: ƒë·∫ßy...", t: "Khu v∆∞·ªùn ƒë·∫ßy hoa h·ªìng." },
        { q: "We‚Äôre a bit short ___ petrol.", o: ["about", "of", "in", "for"], a: "of", h: "short of: thi·∫øu...", t: "Ch√∫ng t√¥i ƒëang h∆°i thi·∫øu xƒÉng." },
        { q: "I‚Äôm not very good_____ drawing.", o: ["at", "in", "for", "on"], a: "at", h: "good at: gi·ªèi (k·ªπ nƒÉng)", t: "T√¥i kh√¥ng gi·ªèi v·∫Ω cho l·∫Øm." },
        { q: "My grandparents are very fond_____ their old cat.", o: ["of", "with", "at", "by"], a: "of", h: "fond of: y√™u th√≠ch", t: "√îng b√† t√¥i r·∫•t y√™u qu√Ω con m√®o gi√† c·ªßa h·ªç." },
        { q: "Cricket is quite different____ baseball.", o: ["for", "with", "to", "from"], a: "from", h: "different from: kh√°c v·ªõi", t: "M√¥n Cricket kh√° kh√°c so v·ªõi b√≥ng ch√†y." },
        { q: "Your hairstyle is quite similar ____mine.", o: ["to", "from", "with", "for"], a: "to", h: "similar to: gi·ªëng v·ªõi", t: "Ki·ªÉu t√≥c c·ªßa b·∫°n kh√° gi·ªëng v·ªõi c·ªßa t√¥i." },
        { q: "She was very angry____ me for losing her key.", o: ["with", "for", "about", "to"], a: "with", h: "angry with: gi·∫≠n ai", t: "C√¥ ·∫•y ƒë√£ r·∫•t gi·∫≠n t√¥i v√¨ l√†m m·∫•t ch√¨a kh√≥a c·ªßa c√¥ ·∫•y." },
        { q: "What are the main differences_____ the two countries?", o: ["into", "for", "with", "between"], a: "between", h: "difference between: s·ª± kh√°c nhau gi·ªØa", t: "S·ª± kh√°c bi·ªát ch√≠nh gi·ªØa hai qu·ªëc gia n√†y l√† g√¨?" },
        { q: "The book, Gone With the Wind, was written _____ Margaret Mitchell.", o: ["by", "of", "with", "to"], a: "by", h: "written by: vi·∫øt b·ªüi", t: "Cu·ªën s√°ch Cu·ªën theo chi·ªÅu gi√≥ ƒë∆∞·ª£c vi·∫øt b·ªüi Margaret Mitchell." },
        { q: "This car isn‚Äôt my. It belongs ___ Mike.", o: ["to", "of", "at", "for"], a: "to", h: "belong to: thu·ªôc v·ªÅ", t: "Chi·∫øc xe n√†y kh√¥ng ph·∫£i c·ªßa t√¥i. N√≥ thu·ªôc v·ªÅ Mike." },
        { q: "Selfish people only care_____ themselves.", o: ["about", "for", "after", "to"], a: "about", h: "care about: quan t√¢m", t: "Nh·ªØng ng∆∞·ªùi √≠ch k·ª∑ ch·ªâ quan t√¢m ƒë·∫øn b·∫£n th√¢n h·ªç." },
        { q: "I won‚Äôt tell anyone what happened. You can rely___ me.", o: ["at", "on", "in", "of"], a: "on", h: "rely on: tin c·∫≠y", t: "T√¥i s·∫Ω kh√¥ng n√≥i v·ªõi ai chuy·ªán ƒë√£ x·∫£y ra. B·∫°n c√≥ th·ªÉ tin t∆∞·ªüng t√¥i." },
        { q: "She apologized___ me for losing her temper.", o: ["at", "towards", "to", "for"], a: "to", h: "apologize to: xin l·ªói ai", t: "C√¥ ·∫•y ƒë√£ xin l·ªói t√¥i v√¨ ƒë√£ m·∫•t b√¨nh tƒ©nh." },
        { q: "I‚Äôve written to the company and applied _____the job.", o: ["for", "about", "of", "with"], a: "for", h: "apply for: n·ªôp ƒë∆°n", t: "T√¥i ƒë√£ vi·∫øt th∆∞ cho c√¥ng ty v√† n·ªôp ƒë∆°n xin vi·ªác." },
        { q: "Mrs. Woods suffers ______ bronchitis.", o: ["from", "with", "by", "to"], a: "from", h: "suffer from: b·ªã b·ªánh g√¨", t: "B√† Woods b·ªã b·ªánh vi√™m ph·∫ø qu·∫£n." },
        { q: "My grandfather died_____ old age.", o: ["at", "of", "in", "to"], a: "of", h: "die of: ch·∫øt v√¨ (l√Ω do t·ª± nhi√™n)", t: "√îng t√¥i m·∫•t v√¨ tu·ªïi gi√†." },
        { q: "We‚Äôre thinking_____ going to the cinema.", o: ["of", "for", "in", "to"], a: "of", h: "think of: nghƒ© v·ªÅ", t: "Ch√∫ng t√¥i ƒëang nghƒ© ƒë·∫øn vi·ªác ƒëi xem phim." },
        { q: "Thank you for looking___ my mother while she was ill.", o: ["for", "after", "at", "in"], a: "after", h: "look after: chƒÉm s√≥c", t: "C·∫£m ∆°n b·∫°n ƒë√£ chƒÉm s√≥c m·∫π t√¥i khi b√† b·ªã ·ªëm." },
        { q: "I don‚Äôt believe___ horoscopes.", o: ["in", "of", "on", "about"], a: "in", h: "believe in: tin v√†o", t: "T√¥i kh√¥ng tin v√†o t·ª≠ vi." },
        { q: "She dreams____ being an actress one day.", o: ["for", "to", "at", "of"], a: "of", h: "dream of: m∆° ∆∞·ªõc th√†nh", t: "C√¥ ·∫•y m∆° ∆∞·ªõc m·ªôt ng√†y n√†o ƒë√≥ s·∫Ω tr·ªü th√†nh di·ªÖn vi√™n." },
        { q: "I dreamt____ my grandmother last night.", o: ["for", "on", "of", "about"], a: "about", h: "dream about: m∆° th·∫•y (khi ng·ªß)", t: "ƒê√™m qua t√¥i ƒë√£ m∆° th·∫•y b√† c·ªßa m√¨nh." },
        { q: "We‚Äôre are depending ____ you to help us.", o: ["to", "at", "of", "on"], a: "on", h: "depend on: ph·ª• thu·ªôc", t: "Ch√∫ng t√¥i ƒëang tr√¥ng c·∫≠y v√†o vi·ªác b·∫°n gi√∫p ƒë·ª° ch√∫ng t√¥i." },
        { q: "The car went out of petrol and crashed _____the back of a bus.", o: ["into", "onto", "to", "in"], a: "into", h: "crash into: ƒë√¢m s·∫ßm v√†o", t: "Chi·∫øc xe h·∫øt xƒÉng v√† ƒë√¢m v√†o ƒëu√¥i xe bu√Ωt." },
        { q: "This town remind me_____ the place where I was born.", o: ["for", "to", "behind", "of"], a: "of", h: "remind of: g·ª£i nh·ªõ", t: "Th·ªã tr·∫•n n√†y l√†m t√¥i nh·ªõ ƒë·∫øn n∆°i t√¥i ƒë√£ sinh ra." },
        { q: "Will you remind Peter _____the party next Sunday?", o: ["about", "for", "with", "on"], a: "about", h: "remind about: nh·∫Øc nh·ªü v·ªÅ", t: "B·∫°n s·∫Ω nh·∫Øc Peter v·ªÅ b·ªØa ti·ªác ch·ªß nh·∫≠t t·ªõi ch·ª©?" },
        { q: "I congratulated Mary ____getting the new job.", o: ["on", "at", "in", "about"], a: "on", h: "congratulate on: ch√∫c m·ª´ng", t: "T√¥i ƒë√£ ch√∫c m·ª´ng Mary v√¨ ƒë√£ c√≥ c√¥ng vi·ªác m·ªõi." },
        { q: "I borrowed the umbrella____ a friend of mine.", o: ["until", "from", "to", "in"], a: "from", h: "borrow from: m∆∞·ª£n t·ª´", t: "T√¥i m∆∞·ª£n chi·∫øc √¥ t·ª´ m·ªôt ng∆∞·ªùi b·∫°n c·ªßa m√¨nh." },
        { q: "They invited us_____ their house for dinner.", o: ["for", "about", "on", "to"], a: "to", h: "invite to: m·ªùi ƒë·∫øn", t: "H·ªç m·ªùi ch√∫ng t√¥i ƒë·∫øn nh√† ƒÉn t·ªëi." },
        { q: "We‚Äôve warned him_____ swimming in that part of the river.", o: ["about", "to", "on", "with"], a: "about", h: "warn about: c·∫£nh b√°o", t: "Ch√∫ng t√¥i ƒë√£ c·∫£nh b√°o anh ·∫•y v·ªÅ vi·ªác b∆°i ·ªü ƒëo·∫°n s√¥ng ƒë√≥." },
        { q: "Could you fill____ the application form, please?", o: ["on", "onto", "for", "in"], a: "in", h: "fill in: ƒëi·ªÅn ƒë∆°n", t: "B·∫°n vui l√≤ng ƒëi·ªÅn v√†o ƒë∆°n ƒëƒÉng k√Ω nh√©?" },
        { q: "They just kept_____ making a noise even though I‚Äôd asked them to stop.", o: ["in", "on", "to", "for"], a: "on", h: "keep on: ti·∫øp t·ª•c", t: "H·ªç c·ª© ti·∫øp t·ª•c g√¢y ·ªìn √†o m·∫∑c d√π t√¥i ƒë√£ y√™u c·∫ßu h·ªç d·ª´ng l·∫°i." },
        { q: "The price of coffee has gone____ again.", o: ["down", "away", "up", "off"], a: "up", h: "go up: tƒÉng l√™n", t: "Gi√° c√† ph√™ l·∫°i tƒÉng m·ªôt l·∫ßn n·ªØa." },
        { q: "It‚Äôs very important ‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶.you to revise your lessons every day .", o: ["for", "to", "on", "with"], a: "for", h: "important for: quan tr·ªçng cho...", t: "Vi·ªác √¥n l·∫°i b√†i m·ªói ng√†y l√† r·∫•t quan tr·ªçng ƒë·ªëi v·ªõi b·∫°n." },
        { q: "Attending classes regularly is very important‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶..us .", o: ["on", "for", "to", "with"], a: "to", h: "important to: quan tr·ªçng v·ªõi ai", t: "Vi·ªác ƒëi h·ªçc ƒë·ªÅu ƒë·∫∑n l√† r·∫•t quan tr·ªçng ƒë·ªëi v·ªõi ch√∫ng t√¥i." },
        { q: "These people are very kind ‚Ä¶‚Ä¶‚Ä¶.animals", o: ["to", "for", "with", "by"], a: "to", h: "kind to: t·ª≠ t·∫ø v·ªõi", t: "Nh·ªØng ng∆∞·ªùi n√†y r·∫•t t·ª≠ t·∫ø v·ªõi ƒë·ªông v·∫≠t." },
        { q: "It is very kind ‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶.. you to give me a lift.", o: ["to", "of", "on", "for"], a: "of", h: "kind of you: th·∫≠t t·ªët b·ª•ng", t: "B·∫°n th·∫≠t t·ªët b·ª•ng khi cho t√¥i ƒëi nh·ªù xe." },
        { q: "Did you know that Linda was engaged ‚Ä¶‚Ä¶‚Ä¶‚Ä¶.. a friend of mine ?", o: ["to", "at", "on", "for"], a: "to", h: "engaged to: ƒë√≠nh h√¥n", t: "B·∫°n c√≥ bi·∫øt Linda ƒë√£ ƒë√≠nh h√¥n v·ªõi m·ªôt ng∆∞·ªùi b·∫°n c·ªßa t√¥i kh√¥ng?" },
        { q: "My sister was married ‚Ä¶‚Ä¶‚Ä¶. a successful businessman.", o: ["to", "with", "from", "about"], a: "to", h: "married to: k·∫øt h√¥n v·ªõi", t: "Em g√°i t√¥i ƒë√£ k·∫øt h√¥n v·ªõi m·ªôt doanh nh√¢n th√†nh ƒë·∫°t." },
        { q: "These days most people are aware ‚Ä¶‚Ä¶‚Ä¶.the danger of smoking.", o: ["for", "of", "in", "to"], a: "of", h: "aware of: nh·∫≠n th·ª©c", t: "Ng√†y nay h·∫ßu h·∫øt m·ªçi ng∆∞·ªùi ƒë·ªÅu nh·∫≠n th·ª©c ƒë∆∞·ª£c s·ª± nguy hi·ªÉm c·ªßa vi·ªác h√∫t thu·ªëc." },
        { q: "We‚Äôre short ‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶staff in our office at the moment .", o: ["with", "for", "at", "of"], a: "of", h: "short of: thi·∫øu...", t: "VƒÉn ph√≤ng ch√∫ng t√¥i hi·ªán ƒëang thi·∫øu nh√¢n s·ª±." },
        { q: "I found a box full ‚Ä¶‚Ä¶‚Ä¶ old letters.", o: ["at", "to", "by", "of"], a: "of", h: "full of: ƒë·∫ßy...", t: "T√¥i t√¨m th·∫•y m·ªôt chi·∫øc h·ªôp ƒë·∫ßy nh·ªØng l√° th∆∞ c≈©." },
        { q: "Searching‚Ä¶‚Ä¶‚Ä¶‚Ä¶alternative fuels is necessary.", o: ["of", "on", "for", "to"], a: "for", h: "search for: t√¨m ki·∫øm", t: "Vi·ªác t√¨m ki·∫øm c√°c ngu·ªìn nhi√™n li·ªáu thay th·∫ø l√† c·∫ßn thi·∫øt." },
        { q: "He participated ‚Ä¶‚Ä¶‚Ä¶.. many cultural activities.", o: ["in", "of", "to", "for"], a: "in", h: "participate in: tham gia", t: "Anh ·∫•y ƒë√£ tham gia nhi·ªÅu ho·∫°t ƒë·ªông vƒÉn h√≥a." },
        { q: "Vehicles account ‚Ä¶‚Ä¶‚Ä¶‚Ä¶air pollution in the cities .", o: ["for", "in", "on", "at"], a: "for", h: "account for: gi·∫£i th√≠ch/chi·∫øm", t: "C√°c ph∆∞∆°ng ti·ªán giao th√¥ng g√¢y ra ph·∫ßn l·ªõn √¥ nhi·ªÖm kh√¥ng kh√≠ trong th√†nh ph·ªë." },
        { q: "If you smoke , there ‚Äòs a greater chance that you‚Äôll die‚Ä¶‚Ä¶‚Ä¶‚Ä¶lung cancer.", o: ["to", "of", "for", "with"], a: "of", h: "die of: ch·∫øt v√¨...", t: "N·∫øu b·∫°n h√∫t thu·ªëc, kh·∫£ nƒÉng b·∫°n ch·∫øt v√¨ ung th∆∞ ph·ªïi s·∫Ω cao h∆°n." },
        { q: "We live ‚Ä¶‚Ä¶‚Ä¶ food .", o: ["on", "in", "at", "for"], a: "on", h: "live on: s·ªëng d·ª±a v√†o", t: "Ch√∫ng ta s·ªëng d·ª±a v√†o th·ª©c ƒÉn." },
        { q: "Don‚Äôt rely‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶..him . He is unreliable .", o: ["at", "for", "on", "to"], a: "on", h: "rely on: tin c·∫≠y", t: "ƒê·ª´ng tin v√†o anh ta. Anh ta kh√¥ng ƒë√°ng tin c·∫≠y ƒë√¢u." },
        { q: "You must concentrate ‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶..your study .", o: ["for", "in", "with", "on"], a: "on", h: "concentrate on: t·∫≠p trung", t: "B·∫°n ph·∫£i t·∫≠p trung v√†o vi·ªác h·ªçc c·ªßa m√¨nh." },
        { q: "We tried to get ‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶ our problems.", o: ["for", "of", "to", "over"], a: "over", h: "get over: v∆∞·ª£t qua", t: "Ch√∫ng t√¥i ƒë√£ c·ªë g·∫Øng v∆∞·ª£t qua nh·ªØng v·∫•n ƒë·ªÅ c·ªßa m√¨nh." },
        { q: "The pilots will use English to ask ‚Ä¶‚Ä¶‚Ä¶‚Ä¶ landing instructions.", o: ["for", "on", "to", "at"], a: "for", h: "ask for: y√™u c·∫ßu", t: "C√°c phi c√¥ng s·∫Ω s·ª≠ d·ª•ng ti·∫øng Anh ƒë·ªÉ y√™u c·∫ßu h∆∞·ªõng d·∫´n h·∫° c√°nh." },
        { q: "Whom will I have to report ‚Ä¶‚Ä¶‚Ä¶‚Ä¶.?", o: ["for", "at", "to", "in"], a: "to", h: "report to: b√°o c√°o ai", t: "T√¥i s·∫Ω ph·∫£i b√°o c√°o cho ai?" },
        { q: "People believed that our natural resources could never be used ‚Ä¶‚Ä¶‚Ä¶‚Ä¶..", o: ["on", "out", "up", "at"], a: "up", h: "use up: d√πng h·∫øt", t: "Ng∆∞·ªùi ta tin r·∫±ng t√†i nguy√™n thi√™n nhi√™n c·ªßa ch√∫ng ta kh√¥ng bao gi·ªù c√≥ th·ªÉ b·ªã c·∫°n ki·ªát." },
        { q: "Water runs ‚Ä¶‚Ä¶ and take the soil ‚Ä¶‚Ä¶ ..it.", o: ["off - with", "out - on", "off - with"], a: "off - with", h: "run off: ch·∫£y ƒëi", t: "N∆∞·ªõc ch·∫£y ƒëi v√† mang theo ƒë·∫•t theo n√≥." },
        { q: "We must put the metal back ‚Ä¶‚Ä¶‚Ä¶use .", o: ["to", "into", "in", "for"], a: "into", h: "put into use: ƒë∆∞a v√†o s·ª≠ d·ª•ng", t: "Ch√∫ng ta ph·∫£i ƒë∆∞a kim lo·∫°i tr·ªü l·∫°i s·ª≠ d·ª•ng." },
        { q: "Would you care ‚Ä¶‚Ä¶‚Ä¶‚Ä¶.. a drink ?", o: ["for", "about", "on", "at"], a: "for", h: "care for: mu·ªën d√πng (m·ªùi)", t: "B·∫°n c√≥ mu·ªën d√πng m·ªôt m√≥n ƒë·ªì u·ªëng kh√¥ng?" },
        { q: "Carbon combined with oxygen turns ‚Ä¶‚Ä¶‚Ä¶‚Ä¶ carbon dioxide.", o: ["to", "into", "with", "in"], a: "into", h: "turn into: bi·∫øn th√†nh", t: "Cacbon k·∫øt h·ª£p v·ªõi oxy bi·∫øn th√†nh kh√≠ cacbonic." },
        { q: "On arriving ‚Ä¶‚Ä¶‚Ä¶.London , he found another explanation .", o: ["to", "in", "at", "for"], a: "at", h: "arrive at: ƒë·∫øn (n∆°i c·ª• th·ªÉ)", t: "Khi ƒë·∫øn London, anh ·∫•y ƒë√£ t√¨m th·∫•y m·ªôt c√°ch gi·∫£i th√≠ch kh√°c." },
        { q: "The man spoke ‚Ä¶‚Ä¶‚Ä¶.. the dog with the sound of whip-lashes.", o: ["with", "to", "at", "for"], a: "to", h: "speak to: n√≥i v·ªõi", t: "Ng∆∞·ªùi ƒë√†n √¥ng n√≥i chuy·ªán v·ªõi ch√∫ ch√≥ b·∫±ng √¢m thanh c·ªßa nh·ªØng nh√°t roi." },
        { q: "We want to help Mum out‚Ä¶‚Ä¶‚Ä¶‚Ä¶the money at home .", o: ["for", "with", "at", "to"], a: "with", h: "help with: gi√∫p vi·ªác g√¨", t: "Ch√∫ng t√¥i mu·ªën gi√∫p m·∫π vi·ªác ti·ªÅn nong ·ªü nh√†." },
        { q: "What can be inferred‚Ä¶‚Ä¶‚Ä¶..the apparent ease of the transition ?", o: ["to", "from", "at", "by"], a: "from", h: "infer from: suy lu·∫≠n", t: "ƒêi·ªÅu g√¨ c√≥ th·ªÉ ƒë∆∞·ª£c suy ra t·ª´ s·ª± d·ªÖ d√†ng r√µ r√†ng c·ªßa qu√° tr√¨nh chuy·ªÉn ƒë·ªïi?" },
        { q: "‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶.what age did you leave school ?", o: ["At", "On", "By", "In"], a: "At", h: "at what age: ·ªü tu·ªïi bao nhi√™u", t: "B·∫°n ƒë√£ ngh·ªâ h·ªçc ·ªü ƒë·ªô tu·ªïi n√†o?" },
        { q: "Why can‚Äôt you do the work straight ‚Ä¶‚Ä¶‚Ä¶‚Ä¶..?", o: ["away", "on", "to", "in"], a: "away", h: "straight away: ngay l·∫≠p t·ª©c", t: "T·∫°i sao b·∫°n kh√¥ng th·ªÉ l√†m c√¥ng vi·ªác ngay l·∫≠p t·ª©c?" },
        { q: "‚Ä¶‚Ä¶‚Ä¶‚Ä¶.the whole, they tend to be informal .", o: ["In", "On", "At", "With"], a: "On", h: "on the whole: nh√¨n chung", t: "Nh√¨n chung, h·ªç c√≥ xu h∆∞·ªõng kh√¥ng ch√≠nh th·ª©c." },
        { q: "He was introduced ‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶my mother.", o: ["with", "to", "for", "at"], a: "to", h: "introduce to: gi·ªõi thi·ªáu", t: "Anh ·∫•y ƒë√£ ƒë∆∞·ª£c gi·ªõi thi·ªáu v·ªõi m·∫π t√¥i." },
        { q: "They usually shake hands ‚Ä¶‚Ä¶‚Ä¶‚Ä¶business occasions.", o: ["on", "at", "for", "in"], a: "on", h: "on occasions: v√†o d·ªãp", t: "H·ªç th∆∞·ªùng b·∫Øt tay nhau v√†o nh·ªØng d·ªãp c√¥ng vi·ªác." },
        { q: "They provided the children ‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶ clothes and food.", o: ["with", "for", "on", "to"], a: "with", h: "provide with: cung c·∫•p", t: "H·ªç ƒë√£ cung c·∫•p qu·∫ßn √°o v√† th·ª©c ƒÉn cho tr·∫ª em." },
        { q: "Who does this car belong ‚Ä¶‚Ä¶‚Ä¶‚Ä¶?", o: ["to", "at", "in", "on"], a: "to", h: "belong to: thu·ªôc v·ªÅ", t: "Chi·∫øc xe n√†y thu·ªôc v·ªÅ ai?" },
        { q: "Many people use English ‚Ä¶‚Ä¶‚Ä¶‚Ä¶ their foreign language.", o: ["like", "as", "for", "in"], a: "as", h: "use as: d√πng nh∆∞ l√†", t: "Nhi·ªÅu ng∆∞·ªùi s·ª≠ d·ª•ng ti·∫øng Anh nh∆∞ l√† ngo·∫°i ng·ªØ c·ªßa h·ªç." },
        { q: "She becomes bored ‚Ä¶‚Ä¶‚Ä¶‚Ä¶ working here.", o: ["with", "to", "on", "for"], a: "with", h: "bored with: ch√°n n·∫£n", t: "C√¥ ·∫•y tr·ªü n√™n ch√°n l√†m vi·ªác ·ªü ƒë√¢y." },
        { q: "He is often late ‚Ä¶‚Ä¶‚Ä¶‚Ä¶ school.", o: ["for", "at", "in", "to"], a: "for", h: "late for: tr·ªÖ...", t: "Anh ·∫•y th∆∞·ªùng xuy√™n ƒëi h·ªçc mu·ªôn." },
        { q: "Many people are involved ‚Ä¶‚Ä¶‚Ä¶ the use of English.", o: ["to", "with", "in", "at"], a: "in", h: "involved in: li√™n quan", t: "Nhi·ªÅu ng∆∞·ªùi c√≥ li√™n quan ƒë·∫øn vi·ªác s·ª≠ d·ª•ng ti·∫øng Anh." },
        { q: "You should go ‚Ä¶‚Ä¶‚Ä¶‚Ä¶ the composition before you hand it in.", o: ["on", "over", "with", "at"], a: "over", h: "go over: xem l·∫°i", t: "B·∫°n n√™n xem l·∫°i b√†i lu·∫≠n tr∆∞·ªõc khi n·ªôp." },
        { q: "I think everything is going ‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶ nicely.", o: ["along", "off", "down", "up"], a: "along", h: "go along: ti·∫øn tri·ªÉn", t: "T√¥i nghƒ© m·ªçi th·ª© ƒëang di·ªÖn ra t·ªët ƒë·∫πp." },
        { q: "I have to work harder to keep pace ‚Ä¶‚Ä¶‚Ä¶ my classmates.", o: ["on", "in", "at", "with"], a: "with", h: "keep pace with: b·∫Øt k·ªãp", t: "T√¥i ph·∫£i h·ªçc t·∫≠p chƒÉm ch·ªâ h∆°n ƒë·ªÉ b·∫Øt k·ªãp c√°c b·∫°n c√πng l·ªõp." },
        { q: "When I entered the room, I caught sight ‚Ä¶‚Ä¶‚Ä¶.. someone in the kitchen.", o: ["for", "to", "of", "with"], a: "of", h: "catch sight of: b·∫Øt g·∫∑p", t: "Khi t√¥i b∆∞·ªõc v√†o ph√≤ng, t√¥i ch·ª£t th·∫•y ai ƒë√≥ trong b·∫øp." },
        { q: "The government is determined to put an end ‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶ corruption.", o: ["for", "to", "of", "with"], a: "to", h: "put an end to: ch·∫•m d·ª©t", t: "Ch√≠nh ph·ªß quy·∫øt t√¢m ch·∫•m d·ª©t t√¨nh tr·∫°ng tham nh≈©ng." },
        { q: "We‚Äôll leave ‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶..Monday .", o: ["at", "on", "with", "to"], a: "on", h: "on + th·ª©: v√†o ng√†y...", t: "Ch√∫ng t√¥i s·∫Ω r·ªùi ƒëi v√†o th·ª© Hai." }
      ];

      const QUIZ_DATA = RAW_QUESTIONS.map((item, index) => ({
        id: index + 1,
        questionText: item.q,
        options: item.o,
        correctAnswer: item.a,
        hint: item.h,
        translation: item.t,
        explanation: `Ghi nh·ªõ: ${item.h}`
      }));

      const Button = ({ children, variant = 'primary', className = '', ...props }) => {
        const variants = {
          primary: "bg-blue-600 text-white shadow hover:bg-blue-700 active:scale-95",
          outline: "bg-white border-2 border-slate-200 text-slate-600 hover:border-blue-400 active:scale-95",
          danger: "bg-rose-500 text-white hover:bg-rose-600 active:scale-95",
        };
        return <button className={`px-5 py-2 rounded-xl font-bold transition-all disabled:opacity-40 ${variants[variant]} ${className}`} {...props}>{children}</button>;
      };

      const StartScreen = ({ onStart }) => {
        const [name, setName] = useState('');
        return (
          <div className="min-h-screen bg-blue-600 flex items-center justify-center p-4">
            <div className="bg-white p-6 sm:p-10 rounded-[2rem] shadow-2xl max-w-sm w-full text-center animate-slide-up">
              <div className="text-5xl mb-3">üìñ</div>
              <h1 className="text-2xl font-black text-slate-800 mb-1 uppercase tracking-tight">IOE K6 Quiz</h1>
              <p className="text-slate-400 font-bold mb-6 tracking-widest text-[9px] uppercase">104 C√¢u H·ªèi Gi·ªõi T·ª´</p>
              <form onSubmit={e => { e.preventDefault(); name.trim() && onStart(name); }}>
                <input type="text" placeholder="T√™n c·ªßa b·∫°n..." value={name} onChange={e => setName(e.target.value)} 
                  className="w-full p-3 rounded-xl border-2 border-slate-100 mb-4 text-lg font-bold text-center outline-none focus:border-blue-500 transition-all" required />
                <Button type="submit" className="w-full text-lg py-3 !rounded-xl uppercase tracking-widest">B·∫ÆT ƒê·∫¶U</Button>
              </form>
            </div>
          </div>
        );
      };

      const QuestionCard = ({ question, onAnswer, isAnswered, userAnswer }) => {
        const [showHint, setShowHint] = useState(false);
        const isCorrect = userAnswer && (userAnswer.trim().toLowerCase() === question.correctAnswer.trim().toLowerCase());
        useEffect(() => { setShowHint(false); }, [question.id]);

        return (
          <div className="w-full max-w-xl mx-auto animate-fade-in px-2">
            <div className="bg-white rounded-2xl shadow-lg border border-slate-100 p-5 sm:p-6 relative">
              <div className="flex justify-between items-center mb-4">
                <span className="bg-blue-50 text-blue-600 px-2 py-0.5 rounded-full text-[9px] font-black tracking-widest uppercase">C√¢u {question.id}</span>
                {!isAnswered && (
                  <button onClick={() => setShowHint(!showHint)} className="text-[9px] font-black text-amber-600 bg-amber-50 px-2 py-0.5 rounded-full border border-amber-100">
                    {showHint ? '·∫®N G·ª¢I √ù' : 'üí° G·ª¢I √ù'}
                  </button>
                )}
              </div>
              {showHint && !isAnswered && (
                <div className="mb-3 p-2 bg-amber-50 rounded-lg border border-amber-200 text-amber-900 font-bold text-[11px] animate-slide-up">{question.hint}</div>
              )}
              <h2 className="text-lg sm:text-xl font-black text-slate-800 mb-6 leading-snug">{question.questionText}</h2>
              <div className="grid grid-cols-1 gap-2">
                {question.options.map((opt, idx) => {
                  const isCurCorrect = opt.trim().toLowerCase() === question.correctAnswer.trim().toLowerCase();
                  const isUserSel = opt.trim().toLowerCase() === (userAnswer ? userAnswer.trim().toLowerCase() : "");
                  let style = "bg-slate-50 border-slate-100 hover:border-blue-300";
                  if (isAnswered) {
                    if (isCurCorrect) style = "bg-emerald-50 border-emerald-500 text-emerald-900 ring-1 ring-emerald-100";
                    else if (isUserSel) style = "bg-rose-50 border-rose-500 text-rose-900 ring-1 ring-rose-100";
                    else style = "opacity-40 border-slate-100";
                  }
                  return (
                    <button key={idx} onClick={() => !isAnswered && onAnswer(opt)} disabled={isAnswered} 
                      className={`p-3 rounded-lg text-left border-2 transition-all flex items-center gap-2 ${style}`}>
                      <div className={`w-6 h-6 rounded flex items-center justify-center font-black text-[10px] ${isAnswered && isCurCorrect ? 'bg-emerald-500 text-white' : 'bg-white text-slate-400 border border-slate-200'}`}>
                        {String.fromCharCode(65+idx)}
                      </div>
                      <span className="text-base font-bold">{opt}</span>
                    </button>
                  );
                })}
              </div>
              {isAnswered && (
                <div className={`mt-4 p-3 rounded-xl border-l-[6px] animate-slide-up ${isCorrect ? 'bg-emerald-50 border-emerald-500' : 'bg-rose-50 border-rose-500'}`}>
                  <h3 className={`font-black text-sm mb-1 ${isCorrect ? 'text-emerald-800' : 'text-rose-800'}`}>{isCorrect ? 'CH√çNH X√ÅC!' : 'SAI M·∫§T R·ªíI!'}</h3>
                  <div className="text-slate-800 font-bold text-[13px] leading-relaxed mb-2">
                    <span className="text-blue-600 uppercase text-[10px] font-black mr-1">D·ªäCH C√ÇU:</span> {question.translation}
                  </div>
                  <p className="text-slate-500 font-bold text-[11px]">{question.explanation}</p>
                </div>
              )}
            </div>
          </div>
        );
      };

      const ResultScreen = ({ userName, userAnswers, onRetryAll, onRetryWrong }) => {
        const correctCount = userAnswers.filter(a => a.isCorrect).length;
        const total = userAnswers.length;
        const score = correctCount * 10;
        const percent = total > 0 ? Math.round((correctCount / total) * 100) : 0;
        const wrongAnswers = userAnswers.filter(a => !a.isCorrect);

        return (
          <div className="min-h-screen bg-slate-50 flex flex-col items-center p-3 py-6">
            <div className="bg-white rounded-2xl shadow-xl p-6 max-w-lg w-full text-center border-2 border-white animate-fade-in mb-6">
              <h2 className="text-xl font-black text-slate-800 mb-3 uppercase">K·∫æT QU·∫¢</h2>
              <div className="text-6xl font-black text-blue-600 mb-1">{percent}%</div>
              <p className="text-slate-500 font-bold mb-6 text-sm">Ng∆∞·ªùi ch∆°i: <span className="text-blue-600">{userName}</span></p>
              <div className="grid grid-cols-3 gap-2 mb-6">
                <div className="bg-blue-50 p-3 rounded-xl border border-blue-100">
                  <div className="text-xl font-black text-blue-600">{score}</div>
                  <div className="text-[8px] font-black uppercase text-blue-700 tracking-widest mt-0.5">ƒêI·ªÇM</div>
                </div>
                <div className="bg-emerald-50 p-3 rounded-xl border border-emerald-100">
                  <div className="text-xl font-black text-emerald-600">{correctCount}</div>
                  <div className="text-[8px] font-black uppercase text-emerald-700 tracking-widest mt-0.5">ƒê√öNG</div>
                </div>
                <div className="bg-rose-50 p-3 rounded-xl border border-rose-100">
                  <div className="text-xl font-black text-rose-500">{total - correctCount}</div>
                  <div className="text-[8px] font-black uppercase text-rose-700 tracking-widest mt-0.5">SAI</div>
                </div>
              </div>
              <div className="flex flex-col gap-2">
                <Button onClick={onRetryAll} className="w-full py-3 text-base">L√ÄM L·∫†I T·∫§T C·∫¢</Button>
                {wrongAnswers.length > 0 && <Button onClick={onRetryWrong} variant="danger" className="w-full py-3 text-base">L√ÄM L·∫†I C√ÇU SAI</Button>}
              </div>
            </div>
            {wrongAnswers.length > 0 && (
              <div className="w-full max-w-lg animate-slide-up">
                <h3 className="text-[10px] font-black text-slate-400 mb-3 uppercase tracking-widest text-center">√în l·∫°i c√°c c√¢u sai</h3>
                <div className="space-y-2">
                  {wrongAnswers.map((ans, i) => {
                    const q = QUIZ_DATA.find(x => x.id === ans.id);
                    return q ? (
                      <div key={i} className="bg-white border border-slate-200 rounded-xl p-4 shadow-sm">
                        <div className="flex justify-between items-start mb-1"><span className="bg-rose-500 text-white text-[8px] font-black px-1.5 py-0.5 rounded uppercase tracking-widest">C√ÇU {q.id}</span></div>
                        <div className="font-bold text-slate-800 mb-3 text-base leading-tight">{q.questionText}</div>
                        <div className="grid grid-cols-2 gap-2 mb-3">
                          <div className="p-2 bg-rose-50 rounded-lg border border-rose-100"><div className="text-[7px] font-black text-rose-400 uppercase mb-0.5">B·∫†N CH·ªåN:</div><div className="text-xs font-bold text-rose-800">{ans.val || "-"}</div></div>
                          <div className="p-2 bg-emerald-50 rounded-lg border border-emerald-100"><div className="text-[7px] font-black text-emerald-400 uppercase mb-0.5">ƒê√ÅP √ÅN ƒê√öNG:</div><div className="text-xs font-bold text-emerald-800">{q.correctAnswer}</div></div>
                        </div>
                        <div className="text-[11px] text-slate-800 font-bold bg-slate-50 p-2 rounded-lg mb-1"><span className="text-blue-500 uppercase text-[8px] font-black mr-1">D·ªäCH:</span> {q.translation}</div>
                        <div className="text-[10px] text-slate-500 font-bold italic">Ghi nh·ªõ: {q.hint}</div>
                      </div>
                    ) : null;
                  })}
                </div>
              </div>
            )}
          </div>
        );
      };

      const App = () => {
        const [gameState, setGameState] = useState(GameState.START);
        const [name, setName] = useState('');
        const [activeQuestions, setActiveQuestions] = useState(QUIZ_DATA);
        const [currentIndex, setCurrentIndex] = useState(0);
        const [userAnswers, setUserAnswers] = useState([]);
        const [showGrid, setShowGrid] = useState(false);

        const handleAnswer = (val) => {
          const q = activeQuestions[currentIndex];
          const isCorrect = val.trim().toLowerCase() === q.correctAnswer.trim().toLowerCase();
          setUserAnswers(prev => [...prev.filter(a => a.id !== q.id), { id: q.id, val, isCorrect }]);
        };

        const onRetryWrong = () => {
          const wrongIds = userAnswers.filter(a => !a.isCorrect).map(a => a.id);
          setActiveQuestions(QUIZ_DATA.filter(q => wrongIds.includes(q.id)));
          setUserAnswers([]); setCurrentIndex(0); setGameState(GameState.PLAYING);
        };

        const onRetryAll = () => { setActiveQuestions(QUIZ_DATA); setUserAnswers([]); setCurrentIndex(0); setGameState(GameState.PLAYING); };

        if (gameState === GameState.START) return <StartScreen onStart={(n) => { setName(n); setGameState(GameState.PLAYING); }} />;
        if (gameState === GameState.FINISHED) return <ResultScreen userName={name} userAnswers={userAnswers} onRetryAll={onRetryAll} onRetryWrong={onRetryWrong} />;

        const currentQ = activeQuestions[currentIndex];
        const answer = userAnswers.find(a => a.id === currentQ.id);
        const score = userAnswers.filter(a => a.isCorrect).length * 10;

        return (
          <div className="min-h-screen pb-20 flex flex-col items-center">
            <header className="w-full bg-white border-b p-2 sticky top-0 z-40 flex justify-between items-center shadow-sm max-w-xl mx-auto rounded-b-xl">
              <div className="flex items-center gap-2">
                <div className="bg-blue-600 text-white w-7 h-7 rounded flex items-center justify-center font-black text-[10px]">üë§</div>
                <span className="font-black text-slate-800 text-xs truncate max-w-[80px]">{name}</span>
              </div>
              <div className="flex gap-3 items-center">
                <div className="text-center"><div className="text-[7px] font-black text-slate-400 uppercase tracking-widest">ƒêI·ªÇM</div><div className="text-base font-black text-blue-600 leading-none">{score}</div></div>
                <div className="text-center"><div className="text-[7px] font-black text-slate-400 uppercase tracking-widest">C√ÇU</div><div className="text-base font-black text-blue-600 leading-none">{currentIndex + 1}/{activeQuestions.length}</div></div>
                <button onClick={() => setShowGrid(true)} className="bg-slate-100 p-1.5 rounded-lg hover:bg-blue-50 transition-all">
                  <svg xmlns="http://www.w3.org/2000/svg" className="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={3} d="M4 6h16M4 12h16M4 18h16" /></svg>
                </button>
              </div>
            </header>
            <div className="w-full max-w-xl px-4 mt-3">
               <div className="w-full bg-slate-200 h-1 rounded-full overflow-hidden"><div className="bg-blue-600 h-full transition-all duration-300" style={{ width: `${((currentIndex + 1) / activeQuestions.length) * 100}%` }}></div></div>
            </div>
            <main className="w-full mt-3"><QuestionCard question={currentQ} onAnswer={handleAnswer} isAnswered={!!answer} userAnswer={answer?.val} /></main>
            <footer className="fixed bottom-0 left-0 right-0 p-3 bg-white/80 backdrop-blur-md border-t border-slate-100 flex justify-center z-40 shadow-lg">
              <div className="max-w-xl w-full flex gap-2">
                <Button variant="outline" onClick={() => setCurrentIndex(Math.max(0, currentIndex - 1))} disabled={currentIndex === 0}>‚Üê</Button>
                <div className="flex-1">
                  {answer ? (
                    <Button onClick={() => currentIndex === activeQuestions.length - 1 ? setGameState(GameState.FINISHED) : setCurrentIndex(currentIndex + 1)} className="w-full uppercase text-xs tracking-widest">{currentIndex === activeQuestions.length - 1 ? 'K·∫æT TH√öC' : 'TI·∫æP THEO'}</Button>
                  ) : (
                    <div className="flex gap-2"><Button variant="outline" onClick={() => setCurrentIndex(Math.min(activeQuestions.length - 1, currentIndex + 1))} className="flex-1 text-xs">B·ªé QUA</Button><Button onClick={() => window.confirm("N·ªôp b√†i?") && setGameState(GameState.FINISHED)} variant="danger" className="flex-1 text-xs uppercase">N·ªòP</Button></div>
                  )}
                </div>
                <Button variant="outline" onClick={() => setCurrentIndex(Math.min(activeQuestions.length - 1, currentIndex + 1))} disabled={currentIndex === activeQuestions.length - 1 || !!answer}>‚Üí</Button>
              </div>
            </footer>
            {showGrid && (
              <div className="fixed inset-0 z-[100] bg-slate-900/60 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in" onClick={() => setShowGrid(false)}>
                <div className="bg-white rounded-2xl shadow-2xl w-full max-w-xs max-h-[60vh] flex flex-col overflow-hidden animate-slide-up" onClick={e => e.stopPropagation()}>
                  <div className="p-4 border-b flex justify-between items-center"><h2 className="text-sm font-black text-slate-800 uppercase">Danh s√°ch</h2><button onClick={() => setShowGrid(false)} className="text-lg">‚úï</button></div>
                  <div className="flex-1 overflow-y-auto p-3 grid grid-cols-5 gap-1.5 custom-scrollbar">
                    {activeQuestions.map((q, idx) => {
                      const ans = userAnswers.find(a => a.id === q.id);
                      let color = "bg-slate-50 text-slate-300 border-slate-100";
                      if (idx === currentIndex) color = "ring-2 ring-blue-500 bg-white text-blue-600 border-blue-500 z-10";
                      else if (ans) color = ans.isCorrect ? "bg-emerald-500 text-white border-emerald-600" : "bg-rose-500 text-white border-rose-600";
                      return <button key={q.id} onClick={() => { setCurrentIndex(idx); setShowGrid(false); }} className={`h-8 rounded font-black text-[10px] border transition-all ${color}`}>{q.id}</button>;
                    })}
                  </div>
                </div>
              </div>
            )}
          </div>
        );
      };
      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
</body>
</html>
